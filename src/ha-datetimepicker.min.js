 /*HA-DateTimePicker v1.1 � 2016 by Hossein Alipour http://hosseinalipour.ir*/
function HaDateTimePicker(e,t){this.solarDate=new HaSolarDate,this.target=e,t=t||{};var a=!!t.isSolar&&"true"===t.isSolar.toString().toLowerCase();this.options={date:t.date||new Date,isSolar:a,maxYear:t.maxYear||a===!0?1450:2050,minYear:t.minYear||a===!0?1350:1950,pagingDuration:t.pagingDuration||600,selectedDate:t.selectedDate||null,minAllowedDate:t.minAllowedDate||null,maxAllowedDate:t.maxAllowedDate||null,forceSetTime:!!t.forceSetTime&&"true"===t.forceSetTime.toString().toLowerCase(),resultInSolar:!!t.resultInSolar&&"true"===t.resultInSolar.toString().toLowerCase(),disableTime:!!t.disableTime&&"true"===t.disableTime.toString().toLowerCase(),resultFormat:t.resultFormat||"{month}/{day}/{year} {t?{hour}:{minute} {ampm}}"},null!=this.options.selectedDate&&(this.selectedTime={hour:this.options.selectedDate.getHours()>=12?this.options.selectedDate.getHours()-12:this.options.selectedDate.getHours(),minute:this.options.selectedDate.getMinutes(),amOrPm:this.options.selectedDate.getHours()>=12?"pm":"am"}),this.options.isSolar===!0?(this.days=this.solarDate.dayNames,this.monthNames=this.solarDate.monthNames,this.renderedDate=this.solarDate.convertFromGregorian(this.options.date),null!=this.options.selectedDate&&(this.selectedDate=this.options.resultInSolar===!1?this.solarDate.convertToGregorian(this.options.selectedDate):new HaSolarDate(this.options.selectedDate.getFullYear(),this.options.selectedDate.getMonth(),this.options.selectedDate.getDate()))):(this.renderedDate=this.options.date,null!=this.options.selectedDate&&(this.selectedDate=this.options.resultInSolar===!1?this.options.selectedDate:this.solarDate.convertToGregorian(new HaSolarDate(this.options.selectedDate.getFullYear(),this.options.selectedDate.getMonth(),this.options.selectedDate.getDate()))),this.days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"]),this.options.maxAllowedDate&&(this.options.maxAllowedDate=this.options.isSolar?new HaSolarDate(this.options.maxAllowedDate):new Date(this.options.maxAllowedDate),this.options.maxYear=Math.min(this.options.maxYear,this.options.maxAllowedDate.getFullYear()),this.solarDate.compare(this.options.maxAllowedDate,this.renderedDate)>0&&(this.renderedDate=this.options.maxAllowedDate)),this.options.minAllowedDate&&(this.options.minAllowedDate=this.options.isSolar?new HaSolarDate(this.options.minAllowedDate):new Date(this.options.minAllowedDate),this.options.minYear=Math.max(this.options.minYear,this.options.minAllowedDate.getFullYear()),this.solarDate.compare(this.options.minAllowedDate,this.options.renderedDate)<0&&(this.renderedDate=this.options.minAllowedDate)),this.options.disableTime===!0&&(this.options.forceSetTime=!1,this.selectedTime=null)}function caseInsensitiveGetAttribute(e,t){for(var a=0;a<e.attributes.length;a++){var i=e.attributes[a];if(t.toLowerCase()===i.name)return i.value}}function twoDigits(e){return e.toString().length<2&&(e="0"+e.toString()),e}function createFragment(e){var t=document.createDocumentFragment(),a=document.createElement("div");for(a.innerHTML=e;a.firstChild;)t.appendChild(a.firstChild);return t}function getMonthLastDay(e,t){new Date;e+1>11&&t++;var a=new Date(t,e+1,0).getDate();return a}HaDateTimePicker.prototype.init=function(){document.querySelectorAll(".ha-datetimepicker").length>0&&document.body.removeChild(document.querySelector(".ha-datetimepicker")),this.createCalendar(),this.setupStyles(),this.renderDate(this.selectedDate||this.renderedDate),this.renderClock(),null!=this.selectedTime&&(this.renderHourHand(),this.renderMinuteHand()),this.addEvents(),this.renderResult()},HaDateTimePicker.prototype.createCalendar=function(){for(var e=1==this.options.isSolar?this.renderedDate.getFullYear().toString().toFaDigit():this.renderedDate.getFullYear(),t=this.options.isSolar?"fa":"en",a="<div class='ha-datetimepicker "+t+"'><div class='ha-dp-dim'></div><div class='ha-datetimepicker-container'><div class='ha-dp-header'><div class='ha-dp-year'><div class='ha-dp-year-dropdown-container'><button type='button' class='ha-dp-year-btn'>"+e+"</button><ul class='ha-dp-year-dropdown'>",i=this.options.minYear;i<=this.options.maxYear;i++){i%10==0&&(a+="<hr class='ha-dp-list-separator'/>");var o=1==this.options.isSolar?i.toString().toFaDigit():i;a+="<li class='ha-dp-year-item' data-year='"+i+"'>"+o+"</li>"}a+="</ul></div></div><div class='ha-dp-month'><button type='button' class='ha-dp-prev-btn'><</button><div class='ha-dp-month-dropdown-container'><button type='button' class='ha-dp-month-btn'>"+this.monthNames[this.renderedDate.getMonth()]+"</button><ul class='ha-dp-month-dropdown'>";for(var s=0;s<this.monthNames.length;s++)a+="<li class='ha-dp-month-item'>"+this.monthNames[s]+"</li>";a+="</ul></div><button type='button' class='ha-dp-next-btn'>></button></div></div>",a+="<div class='ha-dp-body'>",a+="<div>";for(var r=0;r<7;r++){var n=this.options.isSolar?this.days[r][0]:this.days[r];a+="<p class='ha-dp-cell ha-dp-cell-header'>"+n}a+="</div>",a+="<div class='ha-dp-days-container'></div>",a+="</div>",this.options.disableTime===!1&&(a+="<div class='ha-dp-clock'><div class='ha-dp-clock-header'><div class='ha-dp-ampm'><div type='button' class='ha-dp-clock-am-btn"+(this.selectedTime&&"am"==this.selectedTime.amOrPm.toLowerCase()||!this.selectedTime?" selected":"")+"'>AM</div><button type='button' class='ha-dp-clock-ampm-btn"+(this.selectedTime&&"pm"==this.selectedTime.amOrPm.toLowerCase()?" pm":" am")+"'>AMPM</button><div type='button' class='ha-dp-clock-pm-btn"+(this.selectedTime&&"pm"==this.selectedTime.amOrPm.toLowerCase()?" selected":"")+"'>PM</div></div></div><div class='ha-dp-clock-face'><div class='hours-clock-face'></div></div><p class='ha-dp-clock-res'></p><button type='button' class='ha-dp-btn ha-dp-clock-ok-btn'>OK</button></div>"),a+="<div class='ha-dp-footer'><p class='ha-dp-result'>-</p><div class='ha-dp-buttons'><button type='button' class='ha-dp-btn ha-dp-cancel-btn'>Cancel</button><button type='button' class='ha-dp-btn ha-dp-ok-btn'>OK</button>",this.options.disableTime===!1&&(a+="<button type='button' class='ha-dp-btn ha-dp-clock-btn'>Clock</button>"),a+="</div></div>",a+="</div></div>";var l=createFragment(a);document.body.insertBefore(l,document.body.childNodes[document.body.childNodes.length-1])},HaDateTimePicker.prototype.setupStyles=function(){var e=document.querySelector(".ha-dp-days-container");if(e.setAttribute("style","animation-duration:"+this.options.pagingDuration+"ms"),this.options.isSolar){var t=document.querySelector(".ha-dp-body");t.style.direction="rtl"}},HaDateTimePicker.prototype.renderDate=function(e){this.renderedDate=this.options.isSolar?new HaSolarDate(e):new Date(e),this.renderedDate.setDate(1);for(var t=[{daysOfWeek:[]}],a=document.querySelector(".ha-datetimepicker"),i=0;i<a.classList.length;i++)a.classList[i].indexOf("month")>=0&&a.classList.remove(a.classList[i]);a.className+=" month"+e.getMonth();var o,s;1==this.options.isSolar?(s=new HaSolarDate(e.getFullYear(),e.getMonth(),1),o=new HaSolarDate):(s=new Date(e.getFullYear(),e.getMonth(),1),o=new Date);for(var i=-s.getDay()+1,r=1;r<=6;r++){for(var n=new Array,l=1;l<=7;l++)n.push(i++);t.push({daysOfWeek:n})}var c=document.querySelector(".ha-dp-year-btn");c.innerHTML=this.options.isSolar===!0?e.getFullYear().toString().toFaDigit():e.getFullYear();for(var d=document.getElementsByClassName("ha-dp-year-item"),h=0;h<d.length;h++)d[h].classList.contains("selected")&&d[h].classList.remove("selected");var m=document.querySelector(".ha-dp-year-item[data-year='"+e.getFullYear()+"']");null!=m&&(m.className+=" selected");var u=document.querySelector(".ha-dp-month-btn");u.innerHTML=this.monthNames[e.getMonth()];for(var p=document.querySelector(".ha-dp-days-container"),g=this.options.isSolar===!1?getMonthLastDay(e.getMonth(),e.getFullYear()):this.solarDate.getMonthTotalDays(e.getMonth(),e.getFullYear()),D=this.options.isSolar===!1?getMonthLastDay(e.getMonth()-1,e.getFullYear()):this.solarDate.getMonthTotalDays(e.getMonth()-1,e.getFullYear()),v="",f=0;f<t.length;f++){for(var y="<div>",S=0;S<t[f].daysOfWeek.length;S++){var b=t[f].daysOfWeek[S];if(b<=g&&b>0){var k=null!=this.selectedDate&&this.selectedDate.getFullYear()==e.getFullYear()&&this.selectedDate.getMonth()==e.getMonth()&&this.selectedDate.getDate()==b?" ha-dp-cell-selected":"",w="";null!=this.options.minAllowedDate&&(w=this.solarDate.compare(new Date(e.getFullYear(),e.getMonth(),b),this.options.minAllowedDate)>0?" ha-dp-cell-muted":w),null!=this.options.maxAllowedDate&&(w=this.solarDate.compare(new Date(e.getFullYear(),e.getMonth(),b),this.options.maxAllowedDate)<0?" ha-dp-cell-muted":w);var T,A=o.getFullYear()==e.getFullYear()&&o.getMonth()==e.getMonth()&&o.getDate()==b?" ha-dp-cell-currentdate":"";T=this.options.isSolar?6==S?" ha-dp-cell-holiday":"":5==S?" ha-dp-cell-holiday":"";var H=1==this.options.isSolar?b.toString().toFaDigit():b;y+="<p class='ha-dp-cell"+T+A+k+w+"' data-date='"+b+"' data-disp='"+H+"'>"+H+"</p>"}else if(b<1){var H=1==this.options.isSolar?(D+b).toString().toFaDigit():D+b;y+="<p class='ha-dp-cell ha-dp-cell-muted' data-date='"+(D+b)+"'>"+H+"</p>"}else{var H=1==this.options.isSolar?(b-g).toString().toFaDigit():b-g;y+="<p class='ha-dp-cell ha-dp-cell-muted' data-date='"+(b-g)+"'>"+H+"</p>"}}y+="</div>",v+=y}p.innerHTML=v,this.addEvents()},HaDateTimePicker.prototype.changeDate=function(e){var t=document.querySelector(".ha-dp-days-container"),a=this.options.pagingDuration;t.className=t.className.replace("page-left","").replace("page-right","").trim(),this.solarDate.compare(e,this.renderedDate)==-1?t.className+=" page-left":t.className+=" page-right";var i=this;setTimeout(function(){i.options.isSolar?i.renderDate(new HaSolarDate(e.getFullYear(),e.getMonth(),e.getDate())):i.renderDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()))},a/2),setTimeout(function(){t.className=t.className.replace("page-left","").replace("page-right","").trim()},a)},HaDateTimePicker.prototype.addEvents=function(){for(var e=(document.querySelector(".ha-dp-days-container"),new Date),t=this,a=document.querySelectorAll(".ha-dp-cell:not(.ha-dp-cell-muted):not(.ha-dp-cell-header)"),i=0;i<a.length;i++)a[i].onclick=function(){for(var e=0;e<a.length;e++)a[e].className=a[e].className.replace("ha-dp-cell-selected","").trim();this.className+=" ha-dp-cell-selected",t.options.isSolar?t.selectedDate=new HaSolarDate(t.renderedDate.getFullYear(),t.renderedDate.getMonth(),parseInt(this.getAttribute("data-date"))):t.selectedDate=new Date(t.renderedDate.getFullYear(),t.renderedDate.getMonth(),parseInt(this.getAttribute("data-date"))),t.renderResult()};var o=document.querySelector(".ha-dp-dim");o.onclick=function(){t.hide()};var s=document.querySelector(".ha-dp-next-btn"),r=document.querySelector(".ha-dp-prev-btn");s.onclick=function(){var a=t.renderedDate.getFullYear(),i=t.renderedDate.getMonth()+1;i>=12&&(a++,i=0),t.changeDate(new Date(a,i,e.getDate()))},r.onclick=function(){var a=t.renderedDate.getFullYear(),i=t.renderedDate.getMonth()-1;i<0&&(a--,i=11),t.options.isSolar?t.changeDate(new HaSolarDate(a,i,e.getDate())):t.changeDate(new Date(a,i,e.getDate()))};var n=document.querySelector(".ha-dp-month-btn"),l=document.querySelector(".ha-dp-year-btn"),c=document.querySelector(".ha-dp-month-dropdown"),d=document.querySelector(".ha-dp-year-dropdown");document.querySelector("body").addEventListener("click",function(){c.className.indexOf("show")>-1&&(c.className=c.className.replace("show","").trim()),d.className.indexOf("show")>-1&&(d.className=d.className.replace("show","").trim())}),n.onclick=function(e){e.stopPropagation(),d.className.indexOf("show")>-1&&(d.className=d.className.replace("show","").trim()),c.className.indexOf("show")>-1?c.className=c.className.replace("show","").trim():c.className+=" show"},l.onclick=function(e){e.stopPropagation(),c.className.indexOf("show")>-1&&(c.className=c.className.replace("show","").trim()),d.className.indexOf("show")>-1?d.className=d.className.replace("show","").trim():d.className+=" show";var t=document.querySelector(".ha-dp-year-item.selected");if(null!=t){var a=Math.max(t.getAttribute("data-year")-5,document.querySelector(".ha-dp-year-item").getAttribute("data-year"));t=document.querySelector(".ha-dp-year-item[data-year='"+a+"']"),t.scrollIntoView()}};for(var h=document.querySelectorAll(".ha-dp-month-item"),m=0;m<h.length;m++)h[m].index=m,h[m].onclick=function(){if(this.index!=t.renderedDate.getMonth()){var a=this.index;t.changeDate(new Date(t.renderedDate.getFullYear(),a,e.getDate()))}};for(var u=document.querySelectorAll(".ha-dp-year-item"),p=0;p<u.length;p++)u[p].onclick=function(){var a=this.getAttribute("data-year");a!=t.renderedDate.getFullYear()&&t.changeDate(new Date(a,t.renderedDate.getMonth(),e.getDate()))};var g=document.querySelector(".ha-dp-ok-btn");g.onclick=function(){null!=t.returnResults()&&t.hide()};var D=document.querySelector(".ha-dp-cancel-btn");if(D.onclick=function(){t.hide()},this.options.disableTime===!1){var v=document.querySelector(".ha-dp-clock-btn");v.onclick=function(){t.toggleClock()};var f=document.querySelector(".ha-dp-clock-am-btn"),y=document.querySelector(".ha-dp-clock-pm-btn");f.onclick=function(){t.changeAmPm("am")},y.onclick=function(){t.changeAmPm("pm")};var S=document.querySelector(".ha-dp-clock-ampm-btn");S.onclick=function(){t.changeAmPm()};var b=document.querySelector(".ha-dp-clock-ok-btn");b.onclick=function(){t.toggleClock()};var k=!1,w=document.querySelector(".hours-clock-face");w.addEventListener("mouseenter",function(){k=!0}),w.addEventListener("mouseleave",function(){k=!1}),w.onwheel=function(e){if(null!=t.selectedTime){var a=Number(t.selectedTime.hour);e.wheelDelta<0||e.detail>0?t.setTime({hour:a-1}):t.setTime({hour:a+1})}};var T=document.querySelector(".ha-dp-clock-face");T.onwheel=function(e){if(null!=t.selectedTime&&!k){var a=Number(t.selectedTime.minute);e.wheelDelta<0||e.detail>0?t.setTime({minute:a-1}):t.setTime({minute:a+1})}};for(var A=document.querySelectorAll(".ha-dp-clock-num.ha-dp-hour-num .num"),H=0;H<A.length;H++)A[H].onclick=function(){var e=this.getAttribute("data-hour");t.setTime({hour:e})};for(var M=document.querySelectorAll(".ha-dp-clock-num.ha-dp-minute-num .num"),H=0;H<M.length;H++)M[H].onclick=function(){var e=this.getAttribute("data-minute");t.setTime({minute:e})}}},HaDateTimePicker.prototype.setTime=function(e){this.selectedTime||(this.selectedTime={hour:0,minute:0,amOrPm:"AM"}),e.hour>11&&(e.hour=0),e.hour<0&&(e.hour=11),e.minute>59&&(e.minute=0),e.minute<0&&(e.minute=59),this.selectedTime.hour=null!=e.hour?e.hour:this.selectedTime.hour,this.selectedTime.minute=null!=e.minute?e.minute:this.selectedTime.minute,this.selectedTime.amOrPm=null!=e.amOrPm?e.amOrPm:this.selectedTime.amOrPm,this.renderMinuteHand(),this.renderHourHand()},HaDateTimePicker.prototype.toggleClock=function(){if(this.options.disableTime!==!0){var e=document.querySelector(".ha-datetimepicker");this.clock?e.className=e.className.replace("clock","").trim():e.className+=" clock",this.clock=!this.clock,this.renderResult()}},HaDateTimePicker.prototype.renderResult=function(){var e=document.querySelector(".ha-dp-result"),t="";null!=this.selectedDate&&(t=this.options.isSolar?this.selectedDate.getDate()+"/"+(this.selectedDate.getMonth()+1)+"/"+this.selectedDate.getFullYear():this.selectedDate.getMonth()+1+"/"+this.selectedDate.getDate()+"/"+this.selectedDate.getFullYear()),null!=this.selectedTime&&(t+=" "+twoDigits(this.getHours())+":"+twoDigits(this.getMinutes())+" "+this.getAmOrPm().toUpperCase()),e.innerHTML=""==t?"-":0==this.options.isSolar?t:t.toFaDigit()},HaDateTimePicker.prototype.renderHourHand=function(){if(this.options.disableTime!==!0){for(var e=this.selectedTime.hour,t=document.querySelector(".hours-clock-face"),a=document.querySelector(".ha-dp-clock-hour-hand"),i=document.querySelectorAll(".ha-dp-clock-num.ha-dp-hour-num .num.selected"),o=0;o<i.length;o++)i[o].classList.remove("selected");document.querySelector(".ha-datetimepicker [data-hour='"+this.selectedTime.hour+"']").className+=" selected";var s;s=null!=a?a:document.createElement("div"),s.className="ha-dp-clock-hour-hand";var r=180+30*e+.5*this.selectedTime.minute;s.setAttribute("style","-webkit-transform: rotateZ("+r+"deg);-moz-transform: rotateZ("+r+"deg);transform: rotateZ("+r+"deg);"),null==a&&t.appendChild(s),this.renderClockResult()}},HaDateTimePicker.prototype.renderMinuteHand=function(){if(this.options.disableTime!==!0){for(var e=this.selectedTime.minute,t=document.querySelectorAll(".ha-dp-clock-num.ha-dp-minute-num .num.selected"),a=0;a<t.length;a++)t[a].classList.remove("selected");document.querySelector(".ha-datetimepicker [data-minute='"+this.selectedTime.minute+"']").className+=" selected";var i,o=document.querySelector(".ha-dp-clock-face"),s=document.querySelector(".ha-dp-clock-minute-hand");i=null!=s?s:document.createElement("div"),i.className="ha-dp-clock-minute-hand";var r=180+6*e;i.setAttribute("style","-webkit-transform: rotateZ("+r+"deg);-moz-transform: rotateZ("+r+"deg);transform: rotateZ("+r+"deg);"),null==s&&o.appendChild(i),this.renderClockResult()}},HaDateTimePicker.prototype.renderClockResult=function(){if(this.options.disableTime!==!0){var e=document.querySelector(".ha-dp-clock-res");e.innerHTML=twoDigits(this.getHours())+":"+twoDigits(this.getMinutes())+" "+this.getAmOrPm().toUpperCase()}},HaDateTimePicker.prototype.changeAmPm=function(e){if(this.options.disableTime!==!0&&null!=this.selectedTime){var t=document.querySelector(".ha-dp-clock-ampm-btn"),a=document.querySelector(".ha-dp-clock-am-btn"),i=document.querySelector(".ha-dp-clock-pm-btn");(null==e||"am"!=e.toLowerCase()&&"pm"!=e.toLowerCase())&&(e=null==this.selectedTime?"am":"am"===this.selectedTime.amOrPm.toLowerCase()?"pm":"am"),this.selectedTime.amOrPm=e,"am"==e.toLowerCase()?(i.classList.remove("selected"),a.classList.add("selected")):(a.classList.remove("selected"),i.classList.add("selected")),t.classList.remove("am"),t.classList.remove("pm"),t.classList.add(e),this.renderClockResult()}},HaDateTimePicker.prototype.getHours=function(){var e=this.selectedTime.hour;return"pm"==this.selectedTime.amOrPm.toLowerCase()&&0==e&&(e=12),e},HaDateTimePicker.prototype.getMinutes=function(){return this.selectedTime.minute},HaDateTimePicker.prototype.getAmOrPm=function(){return this.selectedTime.amOrPm},HaDateTimePicker.prototype.renderClock=function(){if(this.options.disableTime!==!0){for(var e=document.querySelector(".ha-dp-clock-face"),t=document.querySelector(".hours-clock-face"),a=0;a<12;a++){var i=document.createElement("div");i.className="ha-dp-clock-num ha-dp-hour-num";var o=document.createElement("span");o.setAttribute("data-hour",a),o.className="num",o.innerHTML=0==a?12:a,i.appendChild(o);var s=180+30*a;i.setAttribute("style","-webkit-transform: rotateZ("+s+"deg);-moz-transform: rotateZ("+s+"deg);transform: rotateZ("+s+"deg);"),o.setAttribute("style","-webkit-transform: rotateZ("+-s+"deg);-moz-transform: rotateZ("+-s+"deg);transform: rotateZ("+-s+"deg);"),t.appendChild(i)}for(var r=0;r<60;r++){var i=document.createElement("div");i.className="ha-dp-clock-num ha-dp-minute-num";var o=document.createElement("span");o.setAttribute("data-minute",r),o.className="num",o.innerHTML=r%5==0?0==r||5==r?"0"+r:r:"•",o.className+=r%5!=0?" dot":"",i.appendChild(o);var s=180+6*r;i.setAttribute("style","-webkit-transform: rotateZ("+s+"deg);-moz-transform: rotateZ("+s+"deg);transform: rotateZ("+s+"deg);"),o.setAttribute("style","-webkit-transform: rotateZ("+-s+"deg);-moz-transform: rotateZ("+-s+"deg);transform: rotateZ("+-s+"deg);"),e.appendChild(i)}}},HaDateTimePicker.prototype.returnResults=function(){if(null==this.selectedDate)return null;if(this.options.forceSetTime&&!this.selectedTime)return this.toggleClock(),null;for(var e=document.querySelectorAll(this.target),t=this.getFormatedResult(),a=0;a<e.length;a++){var i=e[a];"input"==i.tagName.toLowerCase()?i.value=t:i.innerHTML=t}return t},HaDateTimePicker.prototype.getResult=function(){var e=this.selectedDate;return!this.options.resultInSolar&&this.options.isSolar&&(e=this.solarDate.convertToGregorian(new HaSolarDate(e.getFullYear(),e.getMonth(),e.getDate()))),!this.options.isSolar&&this.options.resultInSolar&&(e=this.solarDate.convertFromGregorian(new Date(e.getFullYear(),e.getMonth(),e.getDate()))),null!=this.selectedTime&&(e.setHours(this.getHours()),e.setMinutes(this.getMinutes())),e},HaDateTimePicker.prototype.getFormatedResult=function(){var e=this.getResult(),t=this.options.resultFormat;do{var a=t.indexOf("{t?"),i=t.indexOfClosingSymbol(a,"{","}"),o="";a>=0&&(o=t.substr(a,i-a+1),t=null==this.selectedTime?t.replace(o,""):t.removeCharsAt(i).removeCharsAt(a,3))}while(a>=0);do{var s=t.indexOf("{month}")<0&&t.indexOf("{year}")<0&&t.indexOf("{day}")<0;t=t.replace("{month}",e.getMonth()+1).replace("{day}",e.getDate()).replace("{year}",e.getFullYear())}while(!s);do{var r=t.indexOf("{minute}")<0&&t.indexOf("{hour}")<0&&t.indexOf("{ampm}")<0;t=null!=this.selectedTime?t.replace("{hour}",twoDigits(this.getHours())).replace("{minute}",twoDigits(this.getMinutes())).replace("{ampm}",this.getAmOrPm().toUpperCase()):t.replace("{hour}","").replace("{minute}","").replace("{ampm}","")}while(!r);return t.trim()},HaDateTimePicker.prototype.show=function(){this.init(),setTimeout(function(){document.querySelector(".ha-datetimepicker").className+=" show"},10)},HaDateTimePicker.prototype.hide=function(){var e=document.querySelector(".ha-datetimepicker");e.className=e.className.replace("show","").trim()},HaDateTimePicker.init=function(){for(var e=document.querySelectorAll("[data-ha-datetimepicker]"),t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(){this.blur()}),e[t].addEventListener("keydown",function(e){return e.preventDefault(),!1}),e[t].addEventListener("click",function(e){this.blur();var t=caseInsensitiveGetAttribute(this,"data-ha-dp-issolar"),a=caseInsensitiveGetAttribute(this,"data-ha-dp-resultinsolar"),i=new HaDateTimePicker(caseInsensitiveGetAttribute(this,"data-ha-datetimepicker"),{date:caseInsensitiveGetAttribute(this,"data-ha-dp-date"),selectedDate:this.value&&"NaN"!==Date.parse(this.value).toString()?"true"===a?new HaSolarDate(this.value):new Date(this.value):this.innerHTML&&"NaN"!==Date.parse(this.innerHTML).toString()?"true"===a?new HaSolarDate(this.innerHTML):new Date(this.innerHTML):caseInsensitiveGetAttribute(this,"data-ha-dp-selecteddate"),minAllowedDate:caseInsensitiveGetAttribute(this,"data-ha-dp-minalloweddate"),maxAllowedDate:caseInsensitiveGetAttribute(this,"data-ha-dp-maxalloweddate"),pagingDuration:caseInsensitiveGetAttribute(this,"data-ha-dp-pagingduration"),minYear:caseInsensitiveGetAttribute(this,"data-ha-dp-minyear"),maxYear:caseInsensitiveGetAttribute(this,"data-ha-dp-maxyear"),resultInSolar:a,isSolar:t,forceSetTime:caseInsensitiveGetAttribute(this,"data-ha-dp-forcesettime"),disableTime:caseInsensitiveGetAttribute(this,"data-ha-dp-disabletime"),resultFormat:caseInsensitiveGetAttribute(this,"data-ha-dp-resultformat")});i.show()})},String.prototype.toFaDigit=function(){return this.replace(/\d+/g,function(e){for(var t="",a=0;a<e.length;a++)t+=String.fromCharCode(e.charCodeAt(a)+1728);return t})},String.prototype.indexOfAfter=function(e,t){return preIndex=this.indexOf(e),preIndex+this.substring(preIndex).indexOf(t)},String.prototype.removeCharsAt=function(e,t){return t=t||1,this.slice(0,e)+this.slice(e+t)},String.prototype.indexOfClosingSymbol=function(e,t,a){t=t||"{",a=a||"}";for(var i=0,o=e;o<this.length;o++)if(this[o]==t&&i++,this[o]==a&&i--,i<=0)return o;return-1},HaDateTimePicker.init();